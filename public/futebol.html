<!DOCTYPE html>
<html lang="pt">
<head>
   <meta charset="UTF-8">
   <meta name="viewport" content="width=device-width, initial-scale=1.0">
   <title>Casa de Apostas Esportivas</title>
   <link rel="preconnect" href="https://fonts.googleapis.com">
   <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
   <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
   <style>
      body {
         font-family: 'Roboto', sans-serif;
         background-color: #1e1e1e;
         color: #f1f1f1;
         text-align: center;
         padding: 20px;
      }
      select, button, input {
         padding: 10px;
         font-size: 16px;
         margin: 10px;
      }
      .matches, .filters {
         margin-top: 20px;
      }
      .match {
         padding: 10px;
         background-color: #333;
         border-radius: 5px;
         margin: 5px 0;
      }
      table {
         width: 100%;
         margin-top: 30px;
         border-collapse: collapse;
      }
      th, td {
         padding: 10px;
         border: 1px solid #444;
      }
      th {
         background-color: #555;
      }
      .tables-container {
         display: flex;
         justify-content: space-around;
         flex-wrap: wrap;
      }
   </style>
</head>
<body>
   <h1>Casa de Apostas Esportivas</h1>
   
   <select id="countrySelect">
      <option value="">Escolha um país</option>
   </select>
   
   <select id="leagueSelect" style="display: none;"></select>
   
   <button id="fetchGames" style="display: none;">Buscar Jogos</button>
   
   <div class="filters">
      <input type="number" id="goalFilter" placeholder="Digite um valor (ex: 0.5)">
      <button id="applyFilter">Aplicar Filtro</button>
   </div>
   
   <div class="matches" id="matches"></div>

   <div class="tables-container">
      <table>
         <thead>
            <tr>
               <th>Casa</th>
               <th>Visitante</th>
               <th>Jogos com Gols (Casa)</th>
               <th>Jogos com Gols (Fora)</th>
               <th>Total de Gols</th>
            </tr>
         </thead>
         <tbody id="goalStatsTable"></tbody>
      </table>
      
      <table>
         <thead>
            <tr>
               <th>Casa</th>
               <th>Visitante</th>
               <th>Confrontos Diretos</th>
            </tr>
         </thead>
         <tbody id="headToHeadTable"></tbody>
      </table>
   </div>
   
   <script>
      document.getElementById("applyFilter").addEventListener("click", async function() {
         const filterValue = parseFloat(document.getElementById("goalFilter").value);
         if (isNaN(filterValue)) {
            alert("Digite um valor válido!");
            return;
         }
         
         const selectedLeague = document.getElementById("leagueSelect").value;
         if (!selectedLeague) {
            alert("Escolha uma liga primeiro!");
            return;
         }
         
         let tableName = selectedLeague.replace(/\s+/g, "_").toLowerCase() + "_odds";
         
         try {
            const response = await fetch(`https://analise-jpnba.onrender.com/golsemcasa?tableName=${tableName}&minGols=${filterValue}`);
            const data = await response.json();
            
            const goalStatsTable = document.getElementById("goalStatsTable");
            const headToHeadTable = document.getElementById("headToHeadTable");
            goalStatsTable.innerHTML = "";
            headToHeadTable.innerHTML = "";
            
            data.forEach(match => {
               let goalRow = document.createElement("tr");
               goalRow.innerHTML = `
                  <td>${match.time_home}</td>
                  <td>${match.time_away}</td>
                  <td>${match.home_avg >= filterValue ? match.home_avg : '-'}</td>
                  <td>${match.away_avg >= filterValue ? match.away_avg : '-'}</td>
                  <td>${match.total_pontos >= filterValue ? match.total_pontos : '-'}</td>
               `;
               goalStatsTable.appendChild(goalRow);

               let h2hRow = document.createElement("tr");
               h2hRow.innerHTML = `
                  <td>${match.time_home}</td>
                  <td>${match.time_away}</td>
                  <td>${match.confrontos >= filterValue ? match.confrontos : '-'}</td>
               `;
               headToHeadTable.appendChild(h2hRow);
            });
         } catch (error) {
            console.error("Erro ao buscar os dados:", error);
         }
      });
   </script>
</body>
</html>
