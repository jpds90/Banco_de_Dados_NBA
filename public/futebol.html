o<!DOCTYPE html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Estat√≠sticas de Futebol</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f5f5f5;
            text-align: center; /* Centraliza os t√≠tulos */
        }

        header {
            background-color: #2f4f2f;
            color: white;
            text-align: center;
            padding: 15px;
            font-size: 20px;
        }

        .container {
            width: 90%;
            max-width: 900px;
            margin: 20px auto;
            background: white;
            padding: 20px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            border-radius: 10px;
        }

        h2 {
            text-align: center;
            margin-top: 20px;
            color: #2f4f2f;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            background: white;
            border-radius: 8px;
            overflow: hidden;
        }

        th, td {
            padding: 10px;
            text-align: center;
            border: 1px solid #ddd;
        }

        th {
            background: #2f4f2f;
            color: white;
        }

        /* Estrutura para colocar as tabelas lado a lado */
        .last-matches {
            display: flex;
            flex-wrap: wrap; /* Permite quebrar em telas menores */
            justify-content: center;
            gap: 20px;
            margin-top: 20px;
        }

        .team-table {
            width: 45%; /* Mant√©m duas tabelas lado a lado */
            min-width: 300px; /* Garante tamanho adequado em telas pequenas */
            background: white;
            padding: 15px;
            border-radius: 10px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }

        /* Responsividade */
        @media (max-width: 768px) {
            .last-matches {
                flex-direction: column; /* Empilha as tabelas em telas menores */
                align-items: center;
            }

            .team-table {
                width: 100%; /* Ocupa a tela toda no celular */
            }
        }

    </style>
</head>
<body>

        <button onclick="window.location.href='principal.html';">Home</button>
    <header>
        <h1>Estat√≠sticas de Futebol</h1>
    </header>

    <div class="container">
        <select id="countrySelect">
            <option value="">Escolha um pa√≠s</option>
        </select>

        <select id="leagueSelect" style="display: none;">
            <option value="">Escolha uma liga</option>
        </select>

        <button id="fetchGames" style="display: none;">Buscar Jogos</button>

        <h2>Pr√≥ximos Jogos</h2>
        <div class="matches" id="matches"></div>

<table border="1">
    <thead>
        <tr>
            <th>Casa</th>
            <th>Qtd Gols <br> <input type="number" id="goalThresholdInput" placeholder="Digite o limite"></th>
            <th>% Gols</th>
            <th>Fora</th>
            <th>Qtd Gols</th>
            <th>% Gols</th>
            <th>Total % Gols</th>
        </tr>
    </thead>
    <tbody id="goalResultsTable"></tbody>
</table>
<div style="display: flex; gap: 20px;">
    <div>
        <h2>Probabilidade de Vit√≥ria</h2>
            <table border="1">
                <thead>
                    <tr>
                        <th>Time Casa</th>
                        <th>Chance Vit√≥ria Casa</th>
                        <th>Time Fora</th>
                        <th>Chance Vit√≥ria Fora</th>
                    </tr>
                </thead>
                <tbody id="winProbabilityTable">
                    <!-- Aqui ser√£o inseridos os resultados dinamicamente -->
                </tbody>
        </table>
    </div>

    <div>
        <h2>Ambas ou +1,5 Gols</h2>
        <table border="1">
            <thead>
                <tr>
                    <th>Casa</th>
                    <th>Visitante</th>
                    <th>%</th>
                    <th>Status</th>
                </tr>
            </thead>
            <tbody id="goalAveragesTableambas"></tbody>
        </table>
    </div>
</div>
<div style="display: flex; gap: 20px;">
    <div>
        <h2>M√©dia de Gols Feitos</h2>
        <table border="1">
            <thead>
                <tr>
                    <th>Casa</th>
                    <th>Visitante</th>
                    <th>M√©dia de Gols (Casa)</th>
                    <th>M√©dia de Gols (Fora)</th>
                </tr>
            </thead>
            <tbody id="goalAveragesTable"></tbody>
        </table>
    </div>

    <div>
        <h2>M√©dia de Gols Sofridos</h2>
        <table border="1">
            <thead>
                <tr>
                    <th>Casa</th>
                    <th>Visitante</th>
                    <th>M√©dia de Gols (Casa)</th>
                    <th>M√©dia de Gols (Fora)</th>
                </tr>
            </thead>
            <tbody id="goalAveragesTablesofrido"></tbody>
        </table>
    </div>
</div>
        <h2>Confronto Direto</h2>
        <table id="headToHeadTable">
            <thead>
                <tr>
                    <th>Casa</th>
                    <th>Gols</th>
                    <th>Visitante</th>
                    <th>Gols</th>
                    <th>Placar</th>
                </tr>
            </thead>
            <tbody></tbody>
        </table>
<h2>√öltimos 5 Jogos </h2>
<div class="last-matches">
    <div class="team-table">
        <h3 id="teamHomeName5"></h3> <!-- Nome do primeiro time -->
        <table id="teamHomeTable5">
            <thead>
                <tr>
                    <th>Desempenho</th>
                </tr>
            </thead>
            <tbody>
            </tbody>
        </table>
    </div>

    <div class="team-table">
        <h3 id="teamAwayName5"></h3> <!-- Nome do segundo time -->
        <table id="teamAwayTable5">
            <thead>
                <tr>
                    <th>Desempenho</th>
                </tr>
            </thead>
            <tbody>
                <!-- Preencher com dados dos jogos do time visitante -->
            </tbody>
        </table>
    </div>
</div>


<h2>√öltimos 5 Jogos Geral</h2>
<!-- Estrutura para mostrar tabelas lado a lado -->
<div class="last-matches">
    <div class="team-table">
        <h3 id="teamHomeName"></h3> <!-- Nome do primeiro time -->
        <table id="teamHomeTable">
            <thead>
                <tr>
                    <th>Data</th>
                    <th>Casa</th>
                    <th>Fora</th>
                    <th>Placar</th>
                </tr>
            </thead>
            <tbody>
                <!-- Preencher com dados dos jogos do time mandante -->
            </tbody>
        </table>
    </div>

    <div class="team-table">
        <h3 id="teamAwayName"></h3> <!-- Nome do segundo time -->
        <table id="teamAwayTable">
            <thead>
                <tr>
                    <th>Data</th>
                    <th>Casa</th>
                    <th>Fora</th>
                    <th>Placar</th>
                </tr>
            </thead>
            <tbody>
                <!-- Preencher com dados dos jogos do time visitante -->
            </tbody>
        </table>
    </div>
</div>



   <script>
    const countries = {
    "AM√âRICA DO SUL": ["Ta√ßa dos Libertadores"],
    "Europa": ["Liga dos Campe√µes", "Liga Europa", "Liga Confer√™ncia", "Liga das Na√ß√µes"],
    "Brasil": ["S√©rie A","Ta√ßa do Brasil", "Paulista", "Carioca", "Gaucho", "Mineiro", "Ta√ßa do Nordeste", "Goiano", "Catarinense", "Baiano"],
    "Portugal": ["Liga Portugal Betclic", "Ta√ßa de Portugal", "Liga Portugal 2", "Liga 3"],
    "Inglaterra": ["Premier League", "Championship", "Trof√©u FA", "Ta√ßa de Inglaterra", "Liga 1"],
    "Espanha": ["LaLiga", "Segunda Divisi√≥n", "Ta√ßa do Rei de Espanha", "Primeira RFEF - Grupo 1"],
    "It√°lia": ["S√©rie A", "S√©rie B", "Ta√ßa de It√°lia"],
    "Alemanha": ["Bundesliga", "Ta√ßa da Alemanha", "2 Bundesliga", "3 Liga Alema"],
    "Fran√ßa": ["Liga 1", "Liga2", "Nacional"],
    "EUA": ["MLS"],
    "Jap√£o": ["liga j1", "liga j2"],
    "Ar√°bia Saudita": ["Primeira Liga"],
    "Pa√≠ses Baixos": ["Eredivisie", "Ta√ßa KNVB Beker", "Primeira Divis√£o"],
    "Turquia": ["Super liga", "1 lig"],
    "√Åustria": ["Primeira Liga", "Segunda Liga"],
    "B√©lgica": ["Primeira Liga", "Segunda Liga"],
    "Bulg√°ria": ["Liga Parva"],
    "Chipre": ["Primeira Liga"],
    "Cro√°cia": ["Primeira Liga", "Prva NL", "Ta√ßa"],
    "Dinamarca": ["Super liga", "1a Divisao"],
    "Esc√≥cia": ["Primeira Liga", "Divisao 1"],
    "Eslov√°quia": ["Primeira Liga"],
    "Eslov√©nia": ["Liga Prva", "Ta√ßa"],
    "Finl√¢ndia": ["Ta√ßa da Liga"],
    "Gr√©cia": ["Superliga", "Ta√ßa", "Super Liga 2"],
    "Hungria": ["Primeira Liga", "Ta√ßa"],
    "Irlanda": ["Primeira Divis√£o", "Divis√£o 1"],
    "Irlanda do Norte": ["Primeira Liga NIFL"],
    "Israel": ["liga ha al", "Ta√ßa Estadual"],
    "Montenegro": ["Liga Prva Crnogorska"],
    "Pa√≠s de Gales": ["Primeira Liga Cymru"],
    "Pol√≥nia": ["Primeira Liga", "Divisao 1", "Ta√ßa"],
    "Rep√∫blica Checa": ["Primeira Liga", "Ta√ßa MOL", "Segunda Divis√£o"],
    "Rom√©nia": ["Superliga", "Ta√ßa", "Liga 2"],
    "Su√≠√ßa": ["Superliga", "Ta√ßa da Sui√ßa", "Liga Challenge"],
    "Ucr√¢nia": ["Primeira Liga"],
    "Argentina": ["Torneo Betano", "Ta√ßa da Argentina", "Primeira Liga Nacional"],
    "Chile": ["Liga de Primera", "Liga de Ascenso", "Copa Chile"],
    "Col√¥mbia": ["Primeira A", "Primeira B"],
    "Costa Rica": ["Primeira Divis√£o"],
    "Equador": ["Liga Pro"],
    "M√©xico": ["Liga MX", "Liga de Expansion MX", "Liga MX Feminino"],
    "Panam√°": ["Primeira Liga"],
    "Paraguai": ["Copa de Primera"],
    "Peru": ["Liga 1"],
    "Uruguai": ["Liga AUF Uruguaya"],
    "√Åfrica do Sul": ["Primeira Liga"],
    "Angola": ["Girabola"],
    "Arg√©lia": ["1 Divisao"],
    "Austr√°lia": ["Liga A"],
    "Catar": ["Primeira Liga"],
    "China": ["Superliga"],
    "Coreia do Sul": ["Liga K1", "Liga K2"],
    "Egito": ["Primeira Liga"],
    "√çndia": ["Super Liga"],
    "Indon√©sia": ["Liga 1"],
    "Tail√¢ndia": ["Liga 1"],
    "Tanz√¢nia": ["Liga Kuu Bara"],
    "Tun√≠sia": ["Liga Profissional 1"]
    };

const countrySelect = document.getElementById("countrySelect");
const leagueSelect = document.getElementById("leagueSelect");
const fetchGamesButton = document.getElementById("fetchGames");
const matchesDiv = document.getElementById("matches");
const headToHeadTable = document.querySelector("#headToHeadTable tbody");
const winProbabilityTable = document.getElementById("winProbabilityTable");

for (let country in countries) {
    let option = document.createElement("option");
    option.value = country;
    option.textContent = country;
    countrySelect.appendChild(option);
}

countrySelect.addEventListener("change", function() {
    leagueSelect.innerHTML = "<option value=''>Escolha uma liga</option>";
    leagueSelect.style.display = "none";
    fetchGamesButton.style.display = "none";
    matchesDiv.innerHTML = "";

    if (this.value) {
        countries[this.value].forEach(league => {
            let option = document.createElement("option");
            option.value = league;
            option.textContent = league;
            leagueSelect.appendChild(option);
        });
        leagueSelect.style.display = "block";
    }
});

leagueSelect.addEventListener("change", function() {
    fetchGamesButton.style.display = this.value ? "block" : "none";
});

function formatarNomeTime(nome) {
    return nome
        .replace(/(\([^()]*\)|Segue em frente)/g, '');
}

fetchGamesButton.addEventListener("click", async function() {
    const selectedCountry = countrySelect.value;
    const selectedLeague = leagueSelect.value;
    if (!selectedLeague || !selectedCountry) return;

    let formattedCountry = selectedCountry
        .normalize("NFD") // Decomp√µe os caracteres acentuados
        .replace(/[\u0300-\u036f]/g, "") // Remove os acentos e sinais diacr√≠ticos
        .replace(/\s+/g, "_") // Substitui espa√ßos por _
        .toLowerCase(); // Converte para min√∫sculas

    let tableName = `${formattedCountry}_${selectedLeague.normalize("NFD").replace(/[\u0300-\u036f]/g, "").replace(/\s+/g, "_").toLowerCase()}_odds`;

    console.log(`Buscando dados para a tabela: ${tableName}`);

    matchesDiv.innerHTML = "Carregando...";


try {
    const response = await fetch(`https://analise-jpnba.onrender.com/buscar-times?tableName=${tableName}`);
    const result = await response.json();

    matchesDiv.innerHTML = ""; // Limpa o conte√∫do anterior

    if (result.success && result.data.length > 0) {
        result.data.forEach(match => {
            // Formata a data
            const dataJogo = new Date(match.data_jogo);
            const dia = String(dataJogo.getDate()).padStart(2, '0'); // Dia (2 d√≠gitos)
            const mes = String(dataJogo.getMonth() + 1).padStart(2, '0'); // M√™s (2 d√≠gitos)
            const ano = dataJogo.getFullYear(); // Ano
            const horas = String(dataJogo.getHours()).padStart(2, '0'); // Horas (2 d√≠gitos)
            const minutos = String(dataJogo.getMinutes()).padStart(2, '0'); // Minutos (2 d√≠gitos)

            const dataFormatada = `${dia}/${mes}/${ano} ${horas}:${minutos}`;

            // Cria o bot√£o com a data formatada
            let matchElement = document.createElement("button");
            matchElement.classList.add("match-button");
            matchElement.textContent = `${dataFormatada} - ${match.time_home} x ${match.time_away}`;

           

    
                // Adiciona o evento de clique dentro do loop onde o matchElement √© criado
matchElement.addEventListener("click", function() {
    selectedTimeHome = formatarNomeTime(match.time_home);
    selectedTimeAway = formatarNomeTime(match.time_away);

    fetchWinProbability(selectedTimeHome, selectedTimeAway);
    fetchLast10Matches(selectedTimeHome, selectedTimeAway);
    fetchLast5Matches(selectedTimeHome, selectedTimeAway);
    fetchHeadToHead(selectedTimeHome, selectedTimeAway);
    buscarMediasDeGols(selectedTimeHome, selectedTimeAway);
    buscarMediasDeGolssofrido(selectedTimeHome, selectedTimeAway);
    buscarMediasDeGolsambas(selectedTimeHome, selectedTimeAway);
    fetchGoalData();
});


                matchesDiv.appendChild(matchElement);
            });
        } else {
            matchesDiv.innerHTML = "<p>Nenhum jogo encontrado.</p>";
        }
    } catch (error) {
        console.error("Erro ao buscar os jogos:", error);
        matchesDiv.innerHTML = "<p>Erro ao buscar os jogos. Tente novamente.</p>";
    }
});



// üîπ Fun√ß√£o para buscar confrontos diretos de dois times selecionados
async function fetchHeadToHead(timeHome, timeAway) {
    timeHome = formatarNomeTime(timeHome);
    timeAway = formatarNomeTime(timeAway);
    try {
        const url =`https://analise-jpnba.onrender.com/confrontosfutebol1?timeHome=${timeHome}&timeAway=${timeAway}`;
        console.log(`üîç URL da requisi√ß√£o: ${url}`);
        const response = await fetch(url);
        const data = await response.json();
        const headToHeadTable = document.getElementById("headToHeadTable");
        headToHeadTable.innerHTML = "";

        // Verifica se h√° dados v√°lidos
        if (!data || !data.confrontations || data.confrontations.length === 0) {
            headToHeadTable.innerHTML = "<tr><td colspan='5'>Nenhum confronto encontrado</td></tr>";
            return;
        }

        // Exibe os confrontos diretos
        data.confrontations.forEach(match => {
            let row = `<tr>
                <td>${match.timehome}</td>
                <td>${match.resultadohome}</td>
                <td>${match.timeaway}</td>
                <td>${match.resultadoaway}</td>
                <td>${match.total_pontos}</td>
            </tr>`;
            headToHeadTable.innerHTML += row;
        });

        // Exibe as m√©dias de gols nos confrontos diretos
        const averagesRow = `<tr class="average-row">
            <td colspan="5"><strong>M√©dia de Gols:</strong> ${data.home_average_points} x ${data.away_average_points} = ${data.total_points}</td>
        </tr>`;
        headToHeadTable.innerHTML += averagesRow;

    } catch (error) {
        console.error("Erro ao buscar confrontos diretos:", error);
        headToHeadTable.innerHTML = "<tr><td colspan='5'>Erro ao carregar os dados</td></tr>";
    }
}
        async function buscarMediasDeGols(timeHome, timeAway) {
    timeHome = formatarNomeTime(timeHome);
    timeAway = formatarNomeTime(timeAway);

            if (!timeHome || !timeAway) {
                alert("Preencha os nomes dos times.");
                return;
            }

            const url = `https://analise-jpnba.onrender.com/golsfeito?timeHome=${encodeURIComponent(timeHome)}&timeAway=${encodeURIComponent(timeAway)}`;
            console.log(`üîç URL da requisi√ß√£o: ${url}`);

            try {
                const response = await fetch(url);
                const data = await response.json();
                const tableBody = document.getElementById("goalAveragesTable");
                tableBody.innerHTML = "";

                // Se houver erro ou os dados estiverem vazios
                if (!data || Object.keys(data).length === 0 || data.error) {
                    tableBody.innerHTML = "<tr><td colspan='5'>Nenhum dado encontrado</td></tr>";
                    return;
                }

                // Criar uma √∫nica linha na tabela
                const row = document.createElement("tr");
                row.innerHTML = `
                    <td>${data.time_home}</td>
                    <td>${data.time_away}</td>
                    <td>${data.home_avg}</td>
                    <td>${data.away_avg}</td>
                `;
                tableBody.appendChild(row);
                
            } catch (error) {
                console.error("Erro ao buscar as m√©dias de gols Feitos:", error);
                document.getElementById("goalAveragesTable").innerHTML = "<tr><td colspan='5'>Erro ao carregar os dados</td></tr>";
            }
        }

        async function buscarMediasDeGolssofrido(timeHome, timeAway) {
    timeHome = formatarNomeTime(timeHome);
    timeAway = formatarNomeTime(timeAway);

            if (!timeHome || !timeAway) {
                alert("Preencha os nomes dos times.");
                return;
            }

            const url = `https://analise-jpnba.onrender.com/golssofrido?timeHome=${encodeURIComponent(timeHome)}&timeAway=${encodeURIComponent(timeAway)}`;
            console.log(`üîç URL da requisi√ß√£o: ${url}`);

            try {
                const response = await fetch(url);
                const data = await response.json();
                const tableBody = document.getElementById("goalAveragesTablesofrido");
                tableBody.innerHTML = "";

                // Se houver erro ou os dados estiverem vazios
                if (!data || Object.keys(data).length === 0 || data.error) {
                    tableBody.innerHTML = "<tr><td colspan='5'>Nenhum dado encontrado</td></tr>";
                    return;
                }

                // Criar uma √∫nica linha na tabela
                const row = document.createElement("tr");
                row.innerHTML = `
                    <td>${data.time_home}</td>
                    <td>${data.time_away}</td>
                    <td>${data.home_avg}</td>
                    <td>${data.away_avg}</td>
                `;
                tableBody.appendChild(row);
                
            } catch (error) {
                console.error("Erro ao buscar as m√©dias de gols Sofridos:", error);
                document.getElementById("goalAveragesTablesofrido").innerHTML = "<tr><td colspan='5'>Erro ao carregar os dados</td></tr>";
            }
        }
        async function buscarMediasDeGolsambas(timeHome, timeAway) {
    timeHome = formatarNomeTime(timeHome);
    timeAway = formatarNomeTime(timeAway);

            if (!timeHome || !timeAway) {
                alert("Preencha os nomes dos times.");
                return;
            }

            const url = `https://analise-jpnba.onrender.com/ambas?timeHome=${encodeURIComponent(timeHome)}&timeAway=${encodeURIComponent(timeAway)}`;
            console.log(`üîç URL da requisi√ß√£o: ${url}`);

            try {
                const response = await fetch(url);
                const data = await response.json();
                const tableBody = document.getElementById("goalAveragesTableambas");
                tableBody.innerHTML = "";

                // Se houver erro ou os dados estiverem vazios
                if (!data || Object.keys(data).length === 0 || data.error) {
                    tableBody.innerHTML = "<tr><td colspan='5'>Nenhum dado encontrado Ambas Marcam</td></tr>";
                    return;
                }

                // Criar uma √∫nica linha na tabela
                const row = document.createElement("tr");
                row.innerHTML = `
                    <td>${data.time_home}</td>
                    <td>${data.time_away}</td>
                    <td>${data.porcentagem}</td>
                    <td>${data.status}</td>
                `;
                tableBody.appendChild(row);
                
            } catch (error) {
                console.error("Erro ao buscar Ambas ou +1,5 Gols:", error);
                document.getElementById("goalAveragesTableambas").innerHTML = "<tr><td colspan='5'>Erro ao carregar os dados Ambas Marcam</td></tr>";
            }
        }


// üîπ Fun√ß√£o para capturar o clique do usu√°rio e buscar dados dos dois times
function selectTeams(team1, team2) {
    fetchHeadToHead(team1, team2);
    fetchGoalAverages(team1, team2);
}

    // Fun√ß√£o para buscar os √∫ltimos 10 jogos
    // Fun√ß√£o para buscar os √∫ltimos 10 jogos e preencher as tabelas corretas
async function fetchLast10Matches(timeHome, timeAway) {
    // Normaliza os nomes removendo acentos
    const normalizeString = (str) => str.normalize("NFD").replace(/\p{Diacritic}/gu, "");

    timeHome = formatarNomeTime(timeHome);
    timeAway = formatarNomeTime(timeAway);

    try {
        const url = `https://analise-jpnba.onrender.com/ultimos10jogos?timeHome=${timeHome}&timeAway=${timeAway}`;
        console.log(`üîç URL da requisi√ß√£o: ${url}`);
        const response = await fetch(url);
        const data = await response.json();

        // Identifica os elementos das tabelas e t√≠tulos
        const homeTableBody = document.querySelector("#teamHomeTable tbody");
        const awayTableBody = document.querySelector("#teamAwayTable tbody");
        const teamHomeTitle = document.querySelector("#teamHomeName");
        const teamAwayTitle = document.querySelector("#teamAwayName");

        // Define os nomes dos times dinamicamente
        teamHomeTitle.textContent = timeHome;
        teamAwayTitle.textContent = timeAway;

        // Limpa as tabelas antes de preencher
        homeTableBody.innerHTML = "";
        awayTableBody.innerHTML = "";

        data.forEach(match => {
            let timehomeNormalized = normalizeString(match.timehome);
            let timeawayNormalized = normalizeString(match.timeaway);
            let timeHomeNormalized = normalizeString(timeHome);
            let timeAwayNormalized = normalizeString(timeAway);

            let row = `<tr>
                <td>${match.data_hora}</td>
                <td>${match.timehome}</td>
                <td>${match.timeaway}</td>
                <td>${match.resultadohome} x ${match.resultadoaway} (${match.resultado})</td>
            </tr>`;

            // Adiciona na tabela correta (comparando os nomes normalizados)
            if (timehomeNormalized === timeHomeNormalized || timeawayNormalized === timeHomeNormalized) {
                homeTableBody.innerHTML += row;
            }
            if (timehomeNormalized === timeAwayNormalized || timeawayNormalized === timeAwayNormalized) {
                awayTableBody.innerHTML += row;
            }
        });
    } catch (error) {
        console.error("Erro ao buscar os √∫ltimos 10 jogos:", error);
    }
}


async function fetchLast5Matches(timeHome, timeAway) {
    // Normaliza os nomes removendo acentos e espa√ßos extras
    const normalizeString = (str) => str.normalize("NFD").replace(/\p{Diacritic}/gu, "").trim();

    timeHome = normalizeString(timeHome);
    timeAway = normalizeString(timeAway);

    try {
        const url = `https://analise-jpnba.onrender.com/ultimos5jogos?timeHome=${encodeURIComponent(timeHome)}&timeAway=${encodeURIComponent(timeAway)}`;
        const response = await fetch(url);
        const data = await response.json();

        if (!data.timeHome || !data.timeAway) {
            console.error("Erro: Dados dos times n√£o retornados corretamente.");
            return;
        }

        // Atualiza os nomes dos times no HTML
        document.getElementById("teamHomeName5").textContent = data.timeHome.nome;
        document.getElementById("teamAwayName5").textContent = data.timeAway.nome;

        // Preencher a tabela dos √∫ltimos 5 jogos em casa
        preencherTabela("teamHomeTable5", data.timeHome.desempenho_casa);

        // Preencher a tabela dos √∫ltimos 5 jogos fora de casa
        preencherTabela("teamAwayTable5", data.timeAway.desempenho_fora);

    } catch (error) {
        console.error("Erro ao buscar os √∫ltimos 5 jogos:", error);
    }
}

function preencherTabela(tabelaId, desempenho) {
    const tabela = document.getElementById(tabelaId).querySelector("tbody");
    tabela.innerHTML = ""; // Limpa a tabela antes de adicionar novos dados

    for (const resultado of desempenho) {
        const row = document.createElement("tr");
        const cell = document.createElement("td");
        cell.textContent = resultado; // Adiciona os s√≠mbolos (‚úÖ, ‚ùå, ü§ù)
        row.appendChild(cell);
        tabela.appendChild(row);
    }
}


// Fun√ß√£o para buscar os dados de gols feitos em casa e fora
// Fun√ß√£o para fazer a requisi√ß√£o para a API e preencher a tabela
document.getElementById("goalThresholdInput").addEventListener("input", function () {
    fetchGoalData();
});

async function fetchGoalData() {
    const threshold = parseFloat(document.getElementById("goalThresholdInput").value);
    
    // Verifica se o threshold √© um n√∫mero v√°lido antes de buscar
    if (isNaN(threshold) || threshold <= 0) {
        return;
    }

    try {
        const url =`https://analise-jpnba.onrender.com/golsemcasa?timeHome=${selectedTimeHome}&timeAway=${selectedTimeAway}&threshold=${threshold}`;
        console.log(`üîç URL da requisi√ß√£o: ${url}`);
        const response = await fetch(url);
        const data = await response.json();

        document.getElementById("goalResultsTable").innerHTML = `
            <tr>
                <td>${data.time_home}</td>
                <td>${data.home_hits_threshold}</td>
                <td>${(data.home_hits_threshold / 10 * 100).toFixed(2)}%</td>
                <td>${data.time_away}</td>
                <td>${data.away_hits_threshold}</td>
                <td>${(data.away_hits_threshold / 10 * 100).toFixed(2)}%</td>
                <td>${((data.home_hits_threshold / 10 * 100 + data.away_hits_threshold / 10 * 100) / 2).toFixed(2)}%</td>
            </tr>
        `;
    } catch (error) {
        console.error("Erro ao buscar os dados:", error);
    }
}
// Fun√ß√£o para buscar a probabilidade de vit√≥ria
async function fetchWinProbability(timeHome, timeAway) {
    timeHome = formatarNomeTime(timeHome);
    timeAway = formatarNomeTime(timeAway);

    try {
        const response = await fetch(`https://analise-jpnba.onrender.com/probabilidade?timeHome=${timeHome}&timeAway=${timeAway}`);
        const data = await response.json();

        console.log("Dados recebidos:", data); // Verifique os dados no console

        if (!data || !data.home_win_probability || !data.away_win_probability) {
            console.error("Erro nos dados recebidos para probabilidade:", data);
            return;
        }

        document.getElementById("winProbabilityTable").innerHTML = `
            <tr>
                <td>${data.time_home}</td>
                <td>${data.home_win_probability}%</td>
                <td>${data.time_away}</td>
                <td>${data.away_win_probability}%</td>
            </tr>
        `;
    } catch (error) {
        console.error("Erro ao buscar probabilidade de vit√≥ria:", error);
    }
}




</script>
</body>
</html>
